# ch7 同期処理2

- ソフトウェアトランザクショナルメモリ(STM)
  - 従来のロック手法と違ってデッドロックの起きない同期処理

### 7.1.2 チケットロック
- 現実的には、理論的に弱い公平性を満たしてはいないものの、ロック獲得時の競合を減少させるようなアルゴリズムが用いられることがある
  - チケットロックはその一種で、Linuxカーネルでも使われている

### 7.1.3 MCSロック
- アトミック命令でアクセスする変数と、スピン中にアクセスする変数を分離することでオーバヘッドを改善

## 7.2 ソフトウェアトランザクショナルメモリ
- スピンロックやミューテックスなどのアルゴリズムは、ロックを獲得しなければクリティカルセクション中のコードは一切実行されない
- 一方でトランザクショナルメモリは、クリティカルセクション中のコードを投機的に実行し、競合が検知されない場合のみメモリにコミットする。これを楽観的ロックという
- これをソフトウェアによって実現するからソフトウェアトランザクショナルメモリ
- STMの実装手法の一つである Transactional Locking Ⅱ (TL2)を扱う
  - Haskell の STM の基礎になった技術

### 7.2.1 STMの特徴
- STMはミューテックスと異なるので、同じように利用すると問題になる可能性がある
- 特徴4点
  1. トランザクション中のコードは複数回実行される可能性がある
  2. トランザクション宙に副作用のあるコードを実行するべきでない
  3. デッドロックしない
  4. 複数のトランザクション処理を合成可能
